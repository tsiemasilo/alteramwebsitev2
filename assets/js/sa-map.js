// South Africa Map with Provinces

// Simplified GeoJSON data for South Africa provinces (accurate coordinates)
const southAfricaData = {
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "properties": { "name": "Western Cape", "id": "WC" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [18.5, -34.8], [18.4, -34.0], [18.9, -33.5], [19.5, -33.6],
                    [20.0, -33.9], [20.5, -34.1], [21.5, -34.0], [22.5, -33.8],
                    [23.0, -33.9], [23.5, -34.0], [24.0, -33.8], [24.5, -33.7],
                    [25.0, -33.7], [25.5, -33.6], [26.0, -33.7], [26.5, -33.6],
                    [27.0, -33.3], [27.5, -33.0], [28.0, -32.8], [28.5, -32.5],
                    [29.0, -32.2], [29.5, -32.0], [30.0, -31.9], [30.5, -31.8],
                    [31.0, -31.5], [31.5, -31.0], [32.0, -30.5], [32.5, -30.0],
                    [32.8, -29.5], [32.8, -29.0], [32.8, -28.5], [32.8, -28.0],
                    [32.8, -27.5], [32.8, -27.0], [32.5, -26.5], [32.0, -26.0],
                    [31.5, -25.5], [31.0, -25.0], [30.5, -24.5], [30.0, -24.0],
                    [29.5, -23.5], [29.0, -23.0], [28.5, -22.5], [28.0, -22.3],
                    [27.0, -23.0], [26.0, -24.0], [25.0, -25.0], [24.0, -26.0],
                    [23.0, -26.5], [22.0, -26.8], [21.0, -26.8], [20.0, -26.9],
                    [19.0, -27.5], [18.5, -28.0], [18.0, -28.9], [17.8, -30.0],
                    [17.8, -31.0], [17.9, -32.0], [18.0, -33.0], [18.2, -34.0],
                    [18.5, -34.8]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "Northern Cape", "id": "NC" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [16.5, -28.6], [17.0, -29.0], [18.0, -28.9], [19.0, -27.5],
                    [20.0, -26.9], [21.0, -26.8], [22.0, -26.8], [23.0, -26.5],
                    [24.0, -26.0], [25.0, -25.0], [26.0, -24.0], [27.0, -23.0],
                    [28.0, -22.3], [29.0, -23.0], [29.5, -23.5], [30.0, -24.0],
                    [30.0, -24.5], [29.5, -25.0], [29.0, -25.5], [28.5, -26.0],
                    [28.0, -26.5], [27.5, -27.0], [27.0, -27.5], [26.5, -28.0],
                    [26.0, -28.5], [25.5, -29.0], [25.0, -29.3], [24.5, -29.5],
                    [24.0, -29.5], [23.5, -29.3], [23.0, -29.0], [22.5, -28.5],
                    [22.0, -28.5], [21.5, -28.5], [21.0, -28.5], [20.5, -28.7],
                    [20.0, -28.8], [19.5, -28.9], [19.0, -29.0], [18.5, -29.0],
                    [18.0, -28.9], [17.5, -28.8], [17.0, -28.7], [16.5, -28.6]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "Eastern Cape", "id": "EC" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [23.0, -33.9], [23.5, -34.0], [24.0, -33.8], [24.5, -33.7],
                    [25.0, -33.7], [25.5, -33.6], [26.0, -33.7], [26.5, -33.6],
                    [27.0, -33.3], [27.5, -33.0], [28.0, -32.8], [28.5, -32.5],
                    [29.0, -32.2], [29.5, -31.9], [30.0, -31.5], [30.5, -31.0],
                    [31.0, -30.5], [31.5, -30.0], [32.0, -29.5], [32.5, -29.0],
                    [32.8, -28.5], [32.8, -28.0], [32.5, -27.5], [32.0, -27.0],
                    [31.5, -26.8], [31.0, -27.0], [30.5, -27.3], [30.0, -27.5],
                    [29.5, -27.8], [29.0, -28.0], [28.5, -28.3], [28.0, -28.5],
                    [27.5, -28.8], [27.0, -29.0], [26.5, -29.3], [26.0, -29.5],
                    [25.5, -29.8], [25.0, -30.0], [24.5, -30.3], [24.0, -30.5],
                    [23.5, -30.8], [23.0, -31.0], [23.0, -31.5], [23.0, -32.0],
                    [23.0, -32.5], [23.0, -33.0], [23.0, -33.5], [23.0, -33.9]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "Free State", "id": "FS" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [24.0, -26.0], [25.0, -25.0], [26.0, -24.0], [27.0, -23.0],
                    [28.0, -22.3], [29.0, -23.0], [29.5, -23.5], [30.0, -24.0],
                    [30.5, -24.5], [30.8, -25.0], [30.5, -25.5], [30.0, -26.0],
                    [29.5, -26.5], [29.0, -27.0], [28.5, -27.5], [28.0, -28.0],
                    [27.5, -28.5], [27.0, -29.0], [26.5, -29.3], [26.0, -29.5],
                    [25.5, -29.8], [25.0, -30.0], [24.5, -30.0], [24.0, -29.8],
                    [23.5, -29.5], [23.0, -29.0], [23.5, -28.5], [24.0, -28.0],
                    [24.5, -27.5], [24.0, -27.0], [24.0, -26.5], [24.0, -26.0]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "KwaZulu-Natal", "id": "KZN" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [29.0, -28.0], [29.5, -27.8], [30.0, -27.5], [30.5, -27.3],
                    [31.0, -27.0], [31.5, -26.8], [32.0, -27.0], [32.5, -27.5],
                    [32.8, -28.0], [32.8, -28.5], [32.5, -29.0], [32.0, -29.5],
                    [31.5, -30.0], [31.0, -30.5], [30.5, -31.0], [30.0, -31.3],
                    [29.5, -31.5], [29.0, -31.5], [28.5, -31.3], [28.0, -31.0],
                    [27.5, -30.5], [27.5, -30.0], [28.0, -29.5], [28.5, -29.0],
                    [29.0, -28.5], [29.0, -28.0]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "Gauteng", "id": "GP" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [27.5, -25.5], [28.0, -25.5], [28.5, -25.5], [28.8, -25.8],
                    [28.8, -26.2], [28.5, -26.5], [28.0, -26.5], [27.5, -26.5],
                    [27.2, -26.2], [27.2, -25.8], [27.5, -25.5]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "Mpumalanga", "id": "MP" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [28.8, -22.5], [29.5, -22.3], [30.0, -22.5], [30.5, -23.0],
                    [31.0, -23.5], [31.5, -24.0], [32.0, -24.5], [32.0, -25.0],
                    [31.5, -25.5], [31.0, -26.0], [30.5, -26.5], [30.0, -26.8],
                    [29.5, -27.0], [29.0, -27.0], [28.5, -26.8], [28.0, -26.5],
                    [27.8, -26.0], [28.0, -25.5], [28.5, -25.0], [29.0, -24.5],
                    [29.0, -24.0], [28.8, -23.5], [28.5, -23.0], [28.8, -22.5]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "Limpopo", "id": "LP" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [28.0, -22.3], [28.8, -22.5], [29.5, -22.3], [30.0, -22.5],
                    [30.5, -23.0], [31.0, -23.5], [31.5, -24.0], [32.0, -24.5],
                    [32.0, -25.0], [31.5, -25.5], [31.0, -26.0], [30.5, -26.0],
                    [30.0, -25.5], [29.5, -25.0], [29.0, -24.5], [28.5, -24.0],
                    [28.0, -23.5], [27.5, -23.0], [27.0, -23.0], [26.5, -23.5],
                    [26.0, -24.0], [25.5, -24.5], [25.0, -25.0], [24.5, -25.0],
                    [24.0, -24.5], [23.5, -24.0], [23.0, -23.5], [22.5, -23.0],
                    [22.5, -22.5], [23.0, -22.5], [23.5, -22.5], [24.0, -22.5],
                    [24.5, -22.5], [25.0, -22.5], [25.5, -22.5], [26.0, -22.5],
                    [26.5, -22.5], [27.0, -22.5], [27.5, -22.5], [28.0, -22.3]
                ]]
            }
        },
        {
            "type": "Feature",
            "properties": { "name": "North West", "id": "NW" },
            "geometry": {
                "type": "Polygon",
                "coordinates": [[
                    [22.5, -23.0], [23.0, -23.5], [23.5, -24.0], [24.0, -24.5],
                    [24.5, -25.0], [25.0, -25.0], [25.5, -24.8], [26.0, -24.5],
                    [26.5, -24.3], [27.0, -24.5], [27.5, -25.0], [27.8, -25.5],
                    [27.5, -26.0], [27.0, -26.5], [26.5, -27.0], [26.0, -27.3],
                    [25.5, -27.5], [25.0, -27.5], [24.5, -27.3], [24.0, -27.0],
                    [23.5, -26.5], [23.0, -26.0], [22.5, -25.5], [22.5, -25.0],
                    [22.5, -24.5], [22.5, -24.0], [22.5, -23.5], [22.5, -23.0]
                ]]
            }
        }
    ]
};

// Initialize the map
function initSouthAfricaMap() {
    const container = document.getElementById('map-container');
    const svg = d3.select('#south-africa-map');
    
    // Set dimensions
    const width = container.clientWidth;
    const height = 600;
    
    svg.attr('width', width).attr('height', height);
    
    // Create projection centered on South Africa
    const projection = d3.geoMercator()
        .center([25, -29])
        .scale(2800)
        .translate([width / 2, height / 2]);
    
    const path = d3.geoPath().projection(projection);
    
    // Draw provinces
    svg.selectAll('path')
        .data(southAfricaData.features)
        .enter()
        .append('path')
        .attr('d', path)
        .attr('fill', '#e8f0fe')
        .attr('stroke', '#2c3e7a')
        .attr('stroke-width', '2')
        .attr('class', 'province')
        .style('cursor', 'pointer')
        .on('mouseenter', function(event, d) {
            d3.select(this)
                .attr('fill', '#f5a623')
                .attr('stroke-width', '3');
        })
        .on('mouseleave', function(event, d) {
            d3.select(this)
                .attr('fill', '#e8f0fe')
                .attr('stroke-width', '2');
        })
        .append('title')
        .text(d => d.properties.name);
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSouthAfricaMap);
} else {
    initSouthAfricaMap();
}

// Reinitialize on window resize
window.addEventListener('resize', () => {
    d3.select('#south-africa-map').selectAll('*').remove();
    initSouthAfricaMap();
});
